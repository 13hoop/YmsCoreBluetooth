<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="YmsCoreBluetooth : A framework for working with CoreBluetooth. Includes Deanna, an iOS application using YmsCoreBluetooth to communicate with a TI SensorTag." />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>YmsCoreBluetooth</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/kickingvegas/YmsCoreBluetooth">View on GitHub</a>

          <h1 id="project_title">YmsCoreBluetooth</h1>
          <h2 id="project_tagline">A framework for working with CoreBluetooth. Includes Deanna, an iOS application using YmsCoreBluetooth to communicate with a TI SensorTag.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/kickingvegas/YmsCoreBluetooth/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/kickingvegas/YmsCoreBluetooth/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>YmsCoreBluetooth 0.92 (beta)</h1>

<p>A framework for building Bluetooth 4.0 Low Energy (aka Smart or LE) iOS applications using the CoreBluetooth API. Includes Deanna, an iOS application using YmsCoreBluetooth to communicate with a <a href="http://processors.wiki.ti.com/index.php/Bluetooth_SensorTag">TI SensorTag</a>.</p>

<p><a href="http://kickingvegas.github.io/YmsCoreBluetooth/appledoc/index.html">YmsCoreBluetooth API Reference</a></p>

<h2>File Naming Conventions</h2>

<p>The YmsCoreBluetooth framework is the set of files prefixed with <code>YMSCB</code> located in the directory <code>YmsCoreBluetooth</code>.</p>

<p>The files for the iOS application <strong>Deanna</strong> are prefixed with <code>DEA</code> located in the directory <code>Deanna</code>.</p>

<h2>Organizational Structure &amp; Operation</h2>

<p>The organizational structure of the YmsCoreBluetooth framework largely mirrors the CoreBluetooth hierarchy:</p>

<ul>
<li>YMSCBAppService - An application service which manages multiple BLE peripherals

<ul>
<li>YMSCBPeripheral - A BLE peripheral can have multiple BLE services

<ul>
<li>YMSCBService - A BLE service can have multiple BLE characteristics

<ul>
<li>YMSCBCharacteristic </li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul><p>With CoreBluetooth, the API to issue read and write requests to a BLE peripheral is accomplished through the CBPeripheral class and the responses sent back are handled via CBPeripheralDelegate methods. For a BLE peripheral with multiple services, this approach requires the developer to write code to manage read/write requests to different services.</p>

<p>YmsCoreBluetooth framework offers iOS developers a more natural API that is BLE service-centric: <strong>read and write requests to a BLE peripheral are done from the point of view of a BLE service</strong>. Responses can be handled using a callback block or via a notification handler method.</p>

<h2>Recommended Code Walk Through</h2>

<p>To better understand how YmsCoreBluetooth works, it is recommended to first read the source of the following BLE service implementations:</p>

<ul>
<li>DEAAccelerometerService, DEABarometerService, DEAGyroscopeService, DEAHumidityService, DEAMagnetometerService, DEASimpleKeysService, DEATemperatureService</li>
</ul><p>Then the BLE peripheral implementation of the TI SensorTag:</p>

<ul>
<li>DEASensorTag</li>
</ul><p>Then the application service which manages all known peripherals:</p>

<ul>
<li>DEACBAppService</li>
</ul><p>The <a href="http://kickingvegas.github.io/YmsCoreBluetooth/appledoc/hierarchy.html">Class Hierarchy</a> is very instructive in showing the relationship of the above classes to the YmsCoreBluetooth framework.</p>

<h2>Writing your own Bluetooth LE service with YmsCoreBluetooth</h2>

<p>Learn how to write your own Bluetooth LE service by reading the example of how its done for the TI SensorTag in the <a href="http://kickingvegas.github.io/YmsCoreBluetooth/appledoc/docs/tutorial/Tutorial.html">Tutorial</a>.</p>

<h2>Questions</h2>

<p>While quite functional, YmsCoreBluetooth is still very much in an early state and there's always room for improvement. Please submit any questions or <a href="https://github.com/kickingvegas/YmsCoreBluetooth/issues?labels=&amp;milestone=&amp;page=1&amp;state=open">issues to the GitHub project for YmsCoreBluetooth</a>.</p>

<h2>Notes</h2>

<p>Code tested on:</p>

<ul>
<li>iPhone 4S, iOS 6.1.3</li>
<li>TI SensorTag firmware 1.2, 1.3.</li>
</ul><h2>Known Issues</h2>

<ul>
<li>No support is offered for the iOS simulator due to the instability of the CoreBluetooth implementation on it. Use this code only on iOS hardware that supports CoreBluetooth. Given that Apple does not provide technical support for CoreBluetooth behavior on the iOS simulator <a href="http://developer.apple.com/library/ios/#technotes/tn2295/_index.html">TN2295</a>, I feel this is a reasonable position to take. Hopefully in time the iOS simulator will exhibit better CoreBluetooth fidelity.</li>
</ul><h2>Changes</h2>

<h3>Sun May 12 2013 - Moombahton Release (ver 0.92)</h3>

<ul>
<li>Block-based callbacks for central manager scanning, peripheral connection, and peripheral retrieval are now supported.</li>
<li>Watchdog timeout for unanswered peripheral connection requests are now supported.</li>
<li>Significant API changes to YMSCBAppService and YMSCBPeripheral detailed below.</li>
</ul><h4>API 0.92 Changes</h4>

<table border="1">
<tr><td colspan="2"><code>YMSCBAppService</code></td></tr>
<tr>
<td>obsolete</td>
<td><code>- (void)persistPeripherals</code></td>
<td>Replaced by YMSCBStoredPeripherals</td>
</tr>
<tr>
<td>obsolete</td>
<td><code>- (void)loadPeripherals</code></td>
<td>Replaced by YMSCBStoredPeripherals</td>
</tr>
<tr>
<td>new</td>
<td><code>- (id)initWithKnownPeripheralNames:(NSArray *)nameList<br>   queue:(dispatch_queue_t)queue<br>   useStoredPeripherals:(BOOL)useStore;</code></td>
<td>Add support to optionally store peripherals.</td>
</tr>
<tr>
<td>obsolete</td>
<td><code>- (void)connectPeripheral:(NSUInteger)index;</code></td>
<td rowspan="2">Use more accurate name</td>
</tr>
<tr>
<td>replaced by</td>
<td><code>- (void)connectPeripheralAtIndex:(NSUInteger)index<br>   options:(NSDictionary *)options;</code></td>
</tr>
<tr>
<td>obsolete</td>
<td><code>- (void)disconnectPeripheral:(NSUInteger)index;</code></td>
<td rowspan="2">Use more accurate name.</td>
</tr>
<tr>
<td>replaced by</td>
<td><code>- (void)disconnectPeripheralAtIndex:(NSUInteger)index;</code></td>
</tr>
<tr>
<td>new</td>
<td><code>- (void)connectPeripheral:(YMSCBPeripheral *)peripheral<br>   options:(NSDictionary *)options;</code></td>
<td>Mirror CBCentralManager method</td>
</tr>
<tr>
<td>new</td>
<td><code>- (void)cancelPeripheralConnection:(YMSCBPeripheral *)peripheral;</code></td>
<td>Mirror CBCentralManager method</td>
</tr>
<tr>
<td>new</td>
<td><code>- (void)connectPeripheral:(YMSCBPeripheral *)peripheral<br>   options:(NSDictionary *)options<br>   withBlock:(void (^)(YMSCBPeripheral *yp, NSError *error))connectCallback</code></td>
<td>Support block based connection</td>
</tr>
<tr>
<td>new</td>
<td><code>- (void)retrieveConnectedPeripherals</code></td>
<td>Mirror CBCentralManager method</td>
</tr>
<tr>
<td>new</td>
<td><code>- (void)retrieveConnectedPeripheralsWithBlock:<br>(void (^)(CBPeripheral *peripheral))retrieveCallback</code></td>
<td>Support block based connection</td>
</tr>
<tr>
<td>new</td>
<td><code>- (void)retrievePeripherals:(NSArray *)peripheralUUIDs</code></td>
<td>Mirror CBCentralManager method</td>
</tr>
<tr>
<td>new</td>
<td><code>- (void)retrievePeripherals:(NSArray *)peripheralUUIDs<br>   withBlock:(void (^)(CBPeripheral *peripheral))retrieveCallback</code></td>
<td>Support block based connection</td>
</tr>
<tr>
<td>new</td>
<td><code>- (void)scanForPeripheralsWithServices:(NSArray *)serviceUUIDs<br>   options:(NSDictionary *)options<br>   withBlock:<br>(void (^)(CBPeripheral *,NSDictionary *, NSNumber *, NSError *))discoverCallback</code></td>
<td>Support block based connection</td>
</tr>
</table><table border="1">
<tr><td colspan="2"><code>YMSCBPeripheral</code></td></tr>
<tr>
<td>obsolete</td>
<td><code>
- (id)initWithPeripheral:(CBPeripheral *)peripheral
    <br>   baseHi:(int64_t)hi
    <br>   baseLo:(int64_t)lo
    <br>   updateRSSI:(BOOL)update;
</code></td>
<td rowspan="2">Support parent property so that methods on parent can be called directly from an instance of YMSCBPeripheral.</td>
</tr>
<tr>
<td>replaced by</td>
<td><code>
- (id)initWithPeripheral:(CBPeripheral *)peripheral
    <br>   parent:(YMSCBAppService *)owner
    <br>   baseHi:(int64_t)hi
    <br>   baseLo:(int64_t)lo
    <br>   updateRSSI:(BOOL)update;
</code></td>
</tr>
<tr>
<td>new</td>
<td><code>- (void)discoverServices</code></td>
<td>Convenience method to call behavior from YMSCBAppService</td>
</tr>
<tr>
<td>new</td>
<td><code>- (void)connect</code></td>
<td>Convenience method to call behavior from YMSCBAppService</td>
</tr>
<tr>
<td>new</td>
<td><code>- (void)disconnect</code></td>
<td>Convenience method to call behavior from YMSCBAppService</td>
</tr>
</table><h3>Wed May 8 2013</h3>

<ul>
<li>Issue #37 - UI for SensorTag Device Information Service implemented.</li>
</ul><h3>Tue May 7 2013</h3>

<ul>
<li>Bugfixes: #41, #42</li>
</ul><h3>Mon May 6 2013</h3>

<ul>
<li>Issue #19 - First draft of Tutorial written</li>
<li>Added initial support for launching a local notification when <em>Deanna</em> app in the background. The view controller for the SensorTag must be presented before going into the background for local notifications to work.</li>
</ul><h3>Wed May 2 2013</h3>

<ul>
<li>Issue #34 - Updated YmsCoreBluetooth Documentation</li>
</ul><h3>Wed May 1 2013</h3>

<ul>
<li>Improved API for reads and writes using either blocks or notifications.</li>
<li>Issue #12 - Callback blocks for service requests implemented.</li>
<li>Issue #22 - Support for reading SensorTag device info implemented.</li>
<li>Issue #24 - API version implemented.</li>
<li>Bugfix #31 - Remove all UI dependencies in YmsCoreBluetooth. Handling CBCentralManager state is an application UX issue.</li>
</ul><h3>Fri Apr 26 2013</h3>

<ul>
<li>Bugfix #21 - YMSCBService now supports constructor with 128-bit base address.</li>
<li>Issue #23 - Moved SensorTag specific methods (<code>requestConfig</code>, <code>responseConfig</code>, <code>turnOn</code>, <code>turnOff</code>) from YMSCBService.</li>
</ul><h3>Wed Apr 24 2013</h3>

<ul>
<li>Bugfix #5 to support multiple SensorTags is now in. With many thanks to Texas Instruments, a second SensorTag was donated to YmsCoreBluetooth to test for multiple peripherals.</li>
<li>Support for deleting discovered peripherals is in.</li>
<li>Support for discovering unknown peripherals is in.</li>
</ul><h3>Sat Apr 20 2013</h3>

<ul>
<li>Bugfix #15 where connect button is blocked when scanning.</li>
<li>Bugfixes on handling peripheral disconnects.</li>
</ul><h3>Thu Apr 18 2013 - Major Revision</h3>

<ul>
<li>Refactored <code>DECBAppService</code> to support:

<ul>
<li>Separation of peripheral discovery by scanning from peripheral retrieval via stored UUID.</li>
<li>Removed <code>NSNotification</code> messages to use <code>CBCentralManagerDelegate</code> methods instead.</li>
</ul>
</li>
<li>Reorganized physical file directory structure to match that of Xcode project group structure.</li>
<li>Added RSSI display to both peripheral screen and SensorTag screen.</li>
<li>Added connect button per peripherals discovered.</li>
<li>Initial support for multiple SensorTags. (This has not yet been tested, due to the fact that I have only 1 SensorTag to test.)</li>
</ul><h3>Sun Mar 3 2013</h3>

<ul>
<li>First stable release.</li>
<li>Support for communication with all sensors/services on a SensorTag.</li>
<li>Initial documentation for YmsCoreBluetooth API and Deanna source code.</li>
</ul><h3>License</h3>

<pre><code>Copyright 2013 Yummy Melon Software LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

Author: Charles Y. Choi &lt;charles.choi@yummymelon.com&gt;
</code></pre>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">YmsCoreBluetooth maintained by <a href="https://github.com/kickingvegas">kickingvegas</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-9829097-6");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
